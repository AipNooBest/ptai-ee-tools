## Docker


Need to put both hosts into same custom bridge network to be able to connect to Consul container using DNS name as default Docker's bridge network doesn't support name resolution (see https://docs.docker.com/network/bridge/)
```
docker run -d --name="consul" -p 8500:8500 -p 8600:8600 -p 8301:8301 -e 'CONSUL_LOCAL_CONFIG={"leave_on_terminate": true, "node_name": "docker-node", "acl": {"enabled": true,"tokens": {"default": "6726de4a-2c5e-4e1b-ea34-ec24c20bf396"}}}' consul:1.5.3 agent -join=10.0.0.3 -client=0.0.0.0 -advertise=10.0.0.4
```
* advertise IP address used as cluster node IP. This address will be used for 8301 communications  
```
docker build --build-arg JAR_FILE=ptai-integration-service-0.1-spring-boot.jar --build-arg KEYSTORE_FILE=keystore.jks --tag ptai/integration-service:0.1 .
```
```
docker run -d --name="ptai-integration-service" --network domain-bridge --hostname ptai-integration-service.domain.org -p 8443:8443 ptai/integration-service:0.1
```
Need to explicitly set host name that corresponds SSL server certificate as by default Docker assigns autogenerated host name like 9bd62722ad97 and Consul worries about that
``` 
2020/01/28 06:23:10 [WARN] agent: Check "service:integrationService" HTTP request failed: Get https://9bd62722ad97:8443/actuator/health: x509: certificate is valid for ptai.domain.org, not 9bd62722ad97
```